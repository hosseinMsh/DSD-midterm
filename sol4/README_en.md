## 📄 Project Guide: Ramp Wave Generation using PWM on FPGA

---

### 🧠 Project Overview

This project aims to generate a **1kHz linear ramp waveform** using only digital logic—**no DAC required**. By leveraging **10-bit Pulse Width Modulation (PWM)** and passing the output through a simple **RC low-pass filter**, a smooth analog ramp is created from 0V to V<sub>CC</sub> every millisecond.

---

## 🧩 Design Logic

### ✅ Step 1: Ramp Counter

* A 10-bit counter increments from 0 to 1023 and then resets.
* The time between increments is set such that one full ramp cycle takes 1ms.

### ✅ Step 2: PWM Generation

* A PWM output is generated by comparing the ramp value (`ramp_val`) to an internal PWM counter.
* As `ramp_val` increases, the **duty cycle increases**, resulting in a higher average voltage.

### ✅ Step 3: Low-pass Filtering

* A simple **RC filter** converts the PWM signal to an analog voltage.
* Proper RC selection ensures a smooth ramp with minimal ripple.

---

## 📂 File Structure

| File             | Description                                      |
| ---------------- | ------------------------------------------------ |
| `ramp_pwm.v`     | Core module: ramp generator and PWM logic        |
| `ramp_pwm_top.v` | Top-level wrapper to connect to board pins       |
| `tb_ramp_pwm.v`  | Simulation testbench (for ModelSim or QuestaSim) |
| `README.md`      | Project guide in Persian                         |
| `README_en.md`   | Project guide in English (this file)             |

---

## ⚙️ Configurable Parameters

```verilog
parameter CLK_HZ    = 50_000_000;  // Input clock frequency (Hz)
parameter RAMP_FREQ = 1_000;       // Desired ramp frequency (Hz)
parameter PWM_BITS  = 10;          // PWM resolution (bits)
```

### 🔸 Key Calculations

* Ramp steps: 2^10 = 1024
* Step duration:

  $$
  T_{\text{step}} = \frac{1}{f_{\text{ramp}} \times 1024} \approx 976\,\text{ns}
  $$
* Clock divider:

  $$
  \text{Divider} = \frac{50\,MHz}{1\,kHz \times 1024} \approx 48828
  $$
* PWM frequency:

  $$
  f_{\text{PWM}} = \frac{50\,MHz}{1024} \approx 48.8\,kHz
  $$

---

## 🧪 Running Simulation

### ▶️ ModelSim Steps

1. Set `tb_ramp_pwm.v` as the top-level simulation module
2. Run commands:

```tcl
vsim work.tb_ramp_pwm
add wave *
run 5ms
```

### 👁 Observations:

* `ramp_val` counts from 0 to 1023 every 1ms
* `pwm_out` shows increasing duty cycle
* To observe analog behavior: right-click `pwm_out` → **Add > Integrate**

---

## 🛠 Synthesis & FPGA Implementation

### 🧩 Quartus Setup:

1. Set `ramp_pwm_top` as the top module

2. Assign pins in Pin Planner:

   | Signal    | Example (DE2 board) |
   | --------- | ------------------- |
   | `clk_50`  | `CLOCK_50`          |
   | `rst_n`   | `KEY[0]`            |
   | `pwm_out` | `GPIO[0]`           |

3. Compile & program the FPGA

4. Connect `pwm_out` to the RC filter → probe output with oscilloscope

---

## 🔌 RC Filter Recommendation

| R     | C    | Approx. Cutoff Frequency |
| ----- | ---- | ------------------------ |
| 3.3kΩ | 10nF | ≈ 4.8kHz                 |

* If ripple is too high:
  → Increase C to 22nF or add a second RC stage

---

## 📈 Scope Measurements

| Channel | Signal    | Description                     |
| ------- | --------- | ------------------------------- |
| CH1     | `pwm_out` | Raw PWM (\~49kHz, 0–3.3V)       |
| CH2     | Filtered  | Analog ramp: 0–3.3V, 1ms period |

---

## 🚀 Ideas for Extension

* Generate **triangular wave** (up-down counter)
* Use **12-bit** resolution for higher precision
* Implement **arbitrary waveforms** using LUT (ROM)
* Replace PWM with **Sigma-Delta Modulation** for better analog quality

---

## 📃 License

This project is released under the **MIT License**. Feel free to use it for educational, commercial, or research purposes. Attribution is optional but appreciated.

---

## 🌐 Persian Version

To read the Persian guide, see [README.md](README.md).
