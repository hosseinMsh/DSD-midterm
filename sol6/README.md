# CRC Circuit Generator & Testbench

## 🔍 1. توضیح کلی پروژه

هدف این پروژه، **تولید خودکار مدار محاسبه‌ی CRC** (Cyclic Redundancy Check) در زبان Verilog است. کاربر چندجمله‌ای CRC را به صورت ورودی وارد می‌کند (مثلاً `x^4 + x + 1`) و ابزار ما:

- مدار CRC را در قالب فایل `crc.v` تولید می‌کند.
- یک تست‌بنچ برای بررسی صحت عملکرد مدار فراهم می‌سازد (`crc_tb.v`).
- امکان تست و شبیه‌سازی با ورودی‌های نمونه را فراهم می‌کند.

---

## 🧠 2. منطق طراحی مدار CRC

CRC یک فیدبک شیفت رجیستر است که از یک چندجمله‌ای مولد (generator polynomial) تبعیت می‌کند. فرض کنید چندجمله‌ای CRC به صورت زیر است:

```

G(x) = x⁴ + x + 1

```

این چندجمله‌ای نشان می‌دهد که باید یک شیفت‌رجیستر ۴ بیتی طراحی کنیم و ورودی‌های آن به صورت خاصی با هم XOR شوند.

مدار به صورت ترتیبی (با کلاک) داده‌های ورودی را خوانده و با اعمال XOR طبق موقعیت ضرایب، مقدار CRC را در فلیپ‌فلاپ‌ها نگه می‌دارد.

---

## 🧾 3. توضیح کد پایتون

فایل `main.py` شامل مراحل زیر است:

1. **پارس کردن ورودی**
   - از عبارت `x^n + ... + 1` توان‌ها استخراج می‌شود.
2. **تولید فایل Verilog**
   - با استفاده از یک الگوی متنی، کد CRC ساخته می‌شود.
   - فلیپ‌فلاپ‌ها، سیم‌ها و XORها با توجه به موقعیت ضرایب تنظیم می‌شوند.
3. **ذخیره فایل**
   - خروجی در `crc.v` نوشته می‌شود.

### نمونه ورودی:
```

x^4 + x + 1

````

### خروجی CRC Verilog:
```verilog
module crc (
    input clk,
    input data_in,
    output [3:0] crc_out
);

    reg d0;
    reg d1;
    reg d2;
    reg d3;

    always @(posedge clk) begin
        d3 <= d2;
        d2 <= d1;
        d1 <= d0 ^ data_in;
        d0 <= data_in;
    end

    assign crc_out = { d3, d2, d1, d0 };
endmodule
````

---

## 🧪 4. تست‌بنچ Verilog (crc\_tb.v)

برای تست صحت عملکرد مدار، یک تست‌بنچ طراحی شده که چند بیت به ورودی می‌دهد و مقدار `crc_out` را در انتها گزارش می‌کند:

```verilog
module crc_tb;
    reg clk = 0;
    reg data_in = 0;
    wire [3:0] crc_out;

    always #5 clk = ~clk;

    crc uut (
        .clk(clk),
        .data_in(data_in),
        .crc_out(crc_out)
    );

    initial begin
        $display("شروع تست CRC...");
        #10 data_in = 1;
        #10 data_in = 0;
        #10 data_in = 1;
        #10 data_in = 1;
        #10 data_in = 0;
        #10 data_in = 0;
        #10 data_in = 1;
        #10 data_in = 0;
        #10;

        $display("مقدار نهایی CRC: %b", crc_out);
        $finish;
    end
endmodule
```

---

## ⚙️ 5. نحوه اجرا

برای اجرای این پروژه باید `python` و ابزار شبیه‌سازی Verilog مثل `Icarus Verilog` نصب باشد.

### گام‌ها:

1. اجرای کد پایتون:

```bash
python main.py
```

2. وارد کردن چندجمله‌ای به‌صورت:

```
x^4 + x + 1
```

3. اجرای شبیه‌سازی:

```bash
iverilog -o crc_sim crc.v crc_tb.v
vvp crc_sim
```

---

## 🧾 6. نمونه خروجی

```text
شروع تست CRC...
مقدار نهایی CRC: 1101
```

---

## 📌 نتیجه‌گیری

این ابزار به‌صورت اتوماتیک مدار CRC را از روی چندجمله‌ای مولد تولید کرده و تست آن را آسان می‌سازد. توسعه بیشتر می‌تواند شامل موارد زیر باشد:

* پشتیبانی از ورودی‌های باینری به‌صورت فایل
* افزودن Reset به مدار
* پشتیبانی از CRC معکوس یا reflected

---

تهیه‌شده با ❤️ برای طراحی منطقی دیجیتال.
